1c1
< # Copyright (C) 2022 Huawei Device Co., Ltd.
---
> # Copyright (C) 2021 Huawei Device Co., Ltd.
15,16d14
< 
< # Lets callers do '#include <sqlite3.h>'
18,27d15
<   include_dirs = [
<     "include",
<     "//utils/native/base/include",
<   ]
< }
< 
< # This is the configuration used to build sqlite itself.
< # It should not be needed outside of this library.
< config("sqlite3_private_config") {
<   visibility = [ ":*" ]
28a17,43
>   cflags = [
>     "-Wno-shorten-64-to-32",
>     "-Wno-double-promotion",
>     "-Wno-disabled-macro-expansion",
>     "-Wno-float-equal",
>     "-Wno-cast-qual",
>     "-Wno-conversion",
>     "-Wno-cast-align",
>     "-Wno-unused-macros",
>     "-Wno-comma",
>     "-Wno-unreachable-code-break",
>     "-Wno-unreachable-code",
>     "-Wno-unreachable-code-return",
>     "-DSQLITE_THREADSAFE=1",
>     "-DQLITE_DEFAULT_MEMSTATUS=0",
>     "-DSQLITE_LIKE_DOESNT_MATCH_BLOBS",
>     "-DSQLITE_OMIT_DEPRECATED",
>     "-DSQLITE_OMIT_SHARED_CACHE",
>     "-DHAVE_USLEEP",
>     "-DHAVE_UTIME",
>     "-DSQLITE_BYTEORDER=1234",
>     "-DSQLITE_DEFAULT_AUTOVACUUM=0",
>     "-DSQLITE_DEFAULT_MMAP_SIZE=0",
>     "-DSQLITE_CORE",
>     "-DSQLITE_TEMP_STORE=3",
>     "-DSQLITE_OMIT_LOAD_EXTENSION",
>   ]
30,46c45
< 
< group("libsqlite") {
<   public_deps = [ ":sqlite" ]
< }
< 
< ohos_shared_library("sqlite") {
<   visibility = [ "//foundation/distributeddatamgr/*" ]
<   visibility += [ "//foundation/multimodalinput/*" ]
<   visibility +=
<       [ "//hit/fuzzing_test/projects/multimodal_InputService_fuzzer/*" ]
<   visibility += [ "//foundation/communication/*" ]
<   visibility += [ "//build/common/*" ]
<   visibility += [ ":*" ]
<   visibility += [ "//base/security/permission/*" ]
<   visibility += [ "//third_party/libsoup/*" ]
<   visibility += [ "//base/security/access_token/*" ]
< 
---
> ohos_source_set("sqlite") {
48,82d46
< 
<   defines = [
<     "NDEBUG=1",
<     "HAVE_USLEEP=1",
<     "SQLITE_HAVE_ISNAN",
<     "SQLITE_DEFAULT_JOURNAL_SIZE_LIMIT=1048576",
<     "SQLITE_THREADSAFE=2",
<     "SQLITE_TEMP_STORE=3",
<     "SQLITE_POWERSAFE_OVERWRITE=1",
<     "SQLITE_DEFAULT_FILE_FORMAT=4",
<     "SQLITE_DEFAULT_AUTOVACUUM=1",
<     "SQLITE_ENABLE_MEMORY_MANAGEMENT=1",
<     "SQLITE_ENABLE_FTS3",
<     "SQLITE_ENABLE_FTS4",
<     "SQLITE_OMIT_COMPILEOPTION_DIAGS",
<     "SQLITE_OMIT_LOAD_EXTENSION",
<     "SQLITE_DEFAULT_FILE_PERMISSIONS=0660",
<     "SQLITE_SECURE_DELETE",
<     "SQLITE_ENABLE_BATCH_ATOMIC_WRITE",
<     "USE_PREAD64",
<     "fdatasync=fdatasync",
<     "HAVE_MALLOC_H=1",
<     "HAVE_MALLOC_USABLE_SIZE",
<     "SQLITE_DIRECT_OVERFLOW_READ",
<     "SQLITE_HAS_CODEC",
<     "SQLITE3_HW_EXPORT_SYMBOLS",
<     "SQLITE_SHARED_BLOCK_OPTIMIZATION",
<     "SQLITE_CODEC_ATTACH_CHANGED",
<   ]
<   cflags_c = [ "-fvisibility=hidden" ]
<   ldflags = [ "-Wl,--exclude-libs,ALL" ]
<   deps = [
<     "//third_party/openssl:libcrypto_shared",
<     "//utils/native/base:utils",
<   ]
84,119d47
<   configs = [ ":sqlite3_private_config" ]
<   part_name = "common"
< }
< 
< ohos_executable("sqlite3") {
<   include_dirs = [ "include" ]
<   sources = [
<     "src/shell.c",
<     "src/sqlite3.c",
<   ]
< 
<   defines = [
<     "NDEBUG=1",
<     "HAVE_USLEEP=1",
<     "SQLITE_HAVE_ISNAN",
<     "SQLITE_DEFAULT_JOURNAL_SIZE_LIMIT=1048576",
<     "SQLITE_THREADSAFE=2",
<     "SQLITE_TEMP_STORE=3",
<     "SQLITE_POWERSAFE_OVERWRITE=1",
<     "SQLITE_DEFAULT_FILE_FORMAT=4",
<     "SQLITE_DEFAULT_AUTOVACUUM=1",
<     "SQLITE_ENABLE_MEMORY_MANAGEMENT=1",
<     "SQLITE_ENABLE_FTS3",
<     "SQLITE_ENABLE_FTS4",
<     "SQLITE_OMIT_COMPILEOPTION_DIAGS",
<     "SQLITE_OMIT_LOAD_EXTENSION",
<     "SQLITE_DEFAULT_FILE_PERMISSIONS=0600",
<     "SQLITE_SECURE_DELETE",
<     "SQLITE_ENABLE_BATCH_ATOMIC_WRITE",
<     "USE_PREAD64",
<     "fdatasync=fdatasync",
<     "SQLITE_DIRECT_OVERFLOW_READ",
<     "SQLITE_SHARED_BLOCK_OPTIMIZATION",
<   ]
< 
<   cflags = [ "-Wno-error=implicit-function-declaration" ]
