// This file was generated by SquareLine Studio
// SquareLine Studio version: SquareLine Studio 1.3.0
// LVGL version: 8.3.6
// Project name: SquareLine_Project
// ui_control.ca功能
// 获取到当前选择的时间
// 点击开始按钮，从选择的时间开始倒计时
// 点击清理按钮，时间变为初始化，00:10
#include "ui.h"

void clear_ok(lv_event_t *e)
{
	// 修改当前roller选项内容,
	lv_roller_set_selected(ui_MinTime, 0, LV_ANIM_ON);
	lv_roller_set_selected(ui_SecTime, 10, LV_ANIM_ON);
	// 改变开始按钮内容为 Start
	lv_label_set_text(ui_Label1, "Start");
}

void start_ok(lv_event_t *e)
{
	// 获取到当前选择的时间
	// 获取roller 选项ID
	int ui_MinTimeID = lv_roller_get_selected(ui_MinTime);
	char buf_minTime[32];
	int ui_SecTimeID = lv_roller_get_selected(ui_SecTime);
	char buf_secTime[32];

	// 获取roller 选项内容(调试用)
	lv_roller_get_selected_str(ui_MinTime, buf_minTime, sizeof(buf_minTime));
	printf("Selected MinTime ID:%d Text:%s\n", ui_MinTimeID, buf_minTime);

	// 改变开始按钮内容为 Pause暂停，颜色为橙色
	lv_label_set_text(ui_Label1, "Pause");
	lv_obj_set_style_bg_color(ui_Button1, lv_color_hex(0xf88379), LV_PART_MAIN | LV_STATE_PRESSED);

	int countTime = ui_MinTimeID * 60 + ui_SecTimeID; // 总秒数
	printf("Total count:%d\n", countTime);
	// if (countTime == ui_SecTimeID)
	// {
	// 	while (ui_SecTimeID)
	// 	{
	// 		LOS_TaskDelay(1);
	// 		ui_SecTimeID--;
	// 		// 修改当前Sec roller选项内容,
	// 		lv_roller_set_selected(ui_SecTime, ui_SecTimeID, LV_ANIM_ON);
	// 	}
	// 	lv_roller_set_selected(ui_MinTime, 0, LV_ANIM_ON);
	// 	lv_roller_set_selected(ui_SecTime, 0, LV_ANIM_ON);
	// 	return;
	// }
	// while (countTime--)
	// {
	// 	LOS_TaskDelay(1);
	// 	ui_SecTimeID--;
	// 	// 修改当前Sec roller选项内容,
	// 	lv_roller_set_selected(ui_SecTime, ui_SecTimeID, LV_ANIM_ON);
	// 	if (countTime % 60 == 0)
	// 	{
	// 		ui_MinTimeID--;
	// 		ui_SecTime = 59;
	// 	}
	// 	lv_roller_set_selected(ui_MinTime, ui_MinTimeID, LV_ANIM_ON);
	// 	lv_roller_set_selected(ui_SecTime, ui_SecTimeID, LV_ANIM_ON);
	// }

	while (ui_SecTimeID)
	{
		// LOS_TaskDelay(100);
		delay500ms();
		delay500ms();
		ui_SecTimeID--;
		// 修改当前Sec roller选项内容,
		lv_roller_set_selected(ui_SecTime, ui_SecTimeID, LV_ANIM_ON);
	}
	ui_MinTimeID--;
	if (ui_MinTimeID < 0) // 只有秒数
	{
		lv_roller_set_selected(ui_MinTime, 0, LV_ANIM_ON);
		lv_roller_set_selected(ui_SecTime, 0, LV_ANIM_ON);
		return;
	}
	ui_SecTimeID = 59;
	lv_roller_set_selected(ui_MinTime, ui_MinTimeID, LV_ANIM_ON);
	lv_roller_set_selected(ui_SecTime, ui_SecTimeID, LV_ANIM_ON);
	while (ui_MinTimeID)
	{
		while (ui_SecTimeID)
		{
			delay500ms();
			delay500ms();
			ui_SecTimeID--;
			// 修改当前Sec roller选项内容,
			lv_roller_set_selected(ui_SecTime, ui_SecTimeID, LV_ANIM_ON);
		}
		ui_MinTimeID--;
		lv_roller_set_selected(ui_MinTime, ui_MinTimeID, LV_ANIM_ON);
		if (ui_MinTimeID < 0) // 只有秒数
		{
			lv_roller_set_selected(ui_MinTime, 0, LV_ANIM_ON);
			lv_roller_set_selected(ui_SecTime, 0, LV_ANIM_ON);
			return;
		}
	}
}

void ui_control()
{
	int ui_MinTimeID = lv_roller_get_selected(ui_MinTime);
}

void SelectMin(lv_event_t *e)
{
	// 获取roller 选项ID
	int ui_MinTimeID = lv_roller_get_selected(ui_MinTime);
	char buf_minTime[32];
	// 获取roller 选项内容
	lv_roller_get_selected_str(ui_MinTime, buf_minTime, sizeof(buf_minTime));
	printf("Selected MinTime ID:%d Text:%s\n", ui_MinTimeID, buf_minTime);
}

void SelectSec(lv_event_t *e)
{
	// Your code here
}

void delay500ms(void)
{
	unsigned char i, j, k;
	for (i = 15; i > 0; i--)
		for (j = 202; j > 0; j--)
			for (k = 81; k > 0; k--)
				;
}