/**
 * Copyright (c) 2022 Huawei Device Co., Ltd.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#include <stdlib.h>
#include <time.h>
#include "functionalext.h"

struct mktime_struct {
    const char *tz;
    const time_t result;
};

static const struct mktime_struct gResultData[] = {
    {"Pacific/Rarotonga", 1659177614},
    {"Pacific/Wake", 1659177614},
    {"Pacific/Tarawa", 1659177614},
    {"Pacific/Fakaofo", 1659177614},
    {"Pacific/Apia", 1659177614},
    {"Pacific/Kwajalein", 1659177614},
    {"Pacific/Tahiti", 1659177614},
    {"Pacific/Easter", 1659177614},
    {"Pacific/Tongatapu", 1659177614},
    {"Pacific/Guadalcanal", 1659177614},
    {"Pacific/Chuuk", 1659177614},
    {"Pacific/Pitcairn", 1659177614},
    {"Pacific/Pohnpei", 1659177614},
    {"Pacific/Fiji", 1659177614},
    {"Pacific/Majuro", 1659177614},
    {"Pacific/Kiritimati", 1659177614},
    {"Pacific/Port_Moresby", 1659177614},
    {"Pacific/Galapagos", 1659177614},
    {"Pacific/Saipan", 1659177614},
    {"Pacific/Marquesas", 1659177614},
    {"Pacific/Wallis", 1659177614},
    {"Pacific/Palau", 1659177614},
    {"Pacific/Bougainville", 1659177614},
    {"Pacific/Honolulu", 1659177614},
    {"Pacific/Noumea", 1659177614},
    {"Pacific/Pago_Pago", 1659177614},
    {"Pacific/Guam", 1659177614},
    {"Pacific/Auckland", 1659177614},
    {"Pacific/Norfolk", 1659177614},
    {"Pacific/Kosrae", 1659177614},
    {"Pacific/Nauru", 1659177614},
    {"Pacific/Chatham", 1659177614},
    {"Pacific/Efate", 1659177614},
    {"Pacific/Midway", 1659177614},
    {"Pacific/Niue", 1659177614},
    {"Pacific/Enderbury", 1659177614},
    {"Pacific/Funafuti", 1659177614},
    {"Pacific/Gambier", 1659177614},
    {"EET", 1659177614},
    {"MST", 1659177614},
    {"Europe/Dublin", 1659177614},
    {"Europe/Minsk", 1659177614},
    {"Europe/Budapest", 1659177614},
    {"Europe/Riga", 1659177614},
    {"Europe/Jersey", 1659177614},
    {"Europe/London", 1659177614},
    {"Europe/Istanbul", 1659177614},
    {"Europe/Moscow", 1659177614},
    {"Europe/Chisinau", 1659177614},
    {"Europe/Andorra", 1659177614},
    {"Europe/Vaduz", 1659177614},
    {"Europe/Zaporozhye", 1659177614},
    {"Europe/San_Marino", 1659177614},
    {"Europe/Monaco", 1659177614},
    {"Europe/Ulyanovsk", 1659177614},
    {"Europe/Isle_of_Man", 1659177614},
    {"Europe/Tirane", 1659177614},
    {"Europe/Vatican", 1659177614},
    {"Europe/Belgrade", 1659177614},
    {"Europe/Paris", 1659177614},
    {"Europe/Nicosia", 1659177614},
    {"Europe/Athens", 1659177614},
    {"Europe/Malta", 1659177614},
    {"Europe/Astrakhan", 1659177614},
    {"Europe/Bratislava", 1659177614},
    {"Europe/Uzhgorod", 1659177614},
    {"Europe/Zurich", 1659177614},
    {"Europe/Brussels", 1659177614},
    {"Europe/Sofia", 1659177614},
    {"Europe/Kiev", 1659177614},
    {"Europe/Guernsey", 1659177614},
    {"Europe/Busingen", 1659177614},
    {"Europe/Copenhagen", 1659177614},
    {"Europe/Skopje", 1659177614},
    {"Europe/Luxembourg", 1659177614},
    {"Europe/Lisbon", 1659177614},
    {"Europe/Saratov", 1659177614},
    {"Europe/Zagreb", 1659177614},
    {"Europe/Simferopol", 1659177614},
    {"Europe/Amsterdam", 1659177614},
    {"Europe/Oslo", 1659177614},
    {"Europe/Samara", 1659177614},
    {"Europe/Warsaw", 1659177614},
    {"Europe/Prague", 1659177614},
    {"Europe/Vienna", 1659177614},
    {"Europe/Mariehamn", 1659177614},
    {"Europe/Gibraltar", 1659177614},
    {"Europe/Stockholm", 1659177614},
    {"Europe/Tallinn", 1659177614},
    {"Europe/Kaliningrad", 1659177614},
    {"Europe/Podgorica", 1659177614},
    {"Europe/Kirov", 1659177614},
    {"Europe/Helsinki", 1659177614},
    {"Europe/Sarajevo", 1659177614},
    {"Europe/Rome", 1659177614},
    {"Europe/Bucharest", 1659177614},
    {"Europe/Berlin", 1659177614},
    {"Europe/Volgograd", 1659177614},
    {"Europe/Ljubljana", 1659177614},
    {"Europe/Vilnius", 1659177614},
    {"Europe/Madrid", 1659177614},
    {"Antarctica/Casey", 1659177614},
    {"Antarctica/Macquarie", 1659177614},
    {"Antarctica/Rothera", 1659177614},
    {"Antarctica/Vostok", 1659177614},
    {"Antarctica/Davis", 1659177614},
    {"Antarctica/Troll", 1659177614},
    {"Antarctica/Mawson", 1659177614},
    {"Antarctica/McMurdo", 1659177614},
    {"Antarctica/DumontDUrville", 1659177614},
    {"Antarctica/Palmer", 1659177614},
    {"Antarctica/Syowa", 1659177614},
    {"WET", 1659177614},
    {"CST6CDT", 1659177614},
    {"MET", 1659177614},
    {"Arctic/Longyearbyen", 1659177614},
    {"Atlantic/Faroe", 1659177614},
    {"Atlantic/Madeira", 1659177614},
    {"Atlantic/Canary", 1659177614},
    {"Atlantic/Reykjavik", 1659177614},
    {"Atlantic/St_Helena", 1659177614},
    {"Atlantic/South_Georgia", 1659177614},
    {"Atlantic/Azores", 1659177614},
    {"Atlantic/Bermuda", 1659177614},
    {"Atlantic/Stanley", 1659177614},
    {"Atlantic/Cape_Verde", 1659177614},
    {"Africa/Niamey", 1659177614},
    {"Africa/Algiers", 1659177614},
    {"Africa/Maputo", 1659177614},
    {"Africa/Johannesburg", 1659177614},
    {"Africa/Addis_Ababa", 1659177614},
    {"Africa/Malabo", 1659177614},
    {"Africa/Cairo", 1659177614},
    {"Africa/Bissau", 1659177614},
    {"Africa/Ndjamena", 1659177614},
    {"Africa/Tunis", 1659177614},
    {"Africa/Harare", 1659177614},
    {"Africa/El_Aaiun", 1659177614},
    {"Africa/Kampala", 1659177614},
    {"Africa/Libreville", 1659177614},
    {"Africa/Blantyre", 1659177614},
    {"Africa/Brazzaville", 1659177614},
    {"Africa/Bangui", 1659177614},
    {"Africa/Luanda", 1659177614},
    {"Africa/Freetown", 1659177614},
    {"Africa/Casablanca", 1659177614},
    {"Africa/Conakry", 1659177614},
    {"Africa/Kinshasa", 1659177614},
    {"Africa/Dakar", 1659177614},
    {"Africa/Ouagadougou", 1659177614},
    {"Africa/Nouakchott", 1659177614},
    {"Africa/Monrovia", 1659177614},
    {"Africa/Kigali", 1659177614},
    {"Africa/Windhoek", 1659177614},
    {"Africa/Juba", 1659177614},
    {"Africa/Sao_Tome", 1659177614},
    {"Africa/Banjul", 1659177614},
    {"Africa/Mbabane", 1659177614},
    {"Africa/Asmara", 1659177614},
    {"Africa/Djibouti", 1659177614},
    {"Africa/Tripoli", 1659177614},
    {"Africa/Ceuta", 1659177614},
    {"Africa/Khartoum", 1659177614},
    {"Africa/Bamako", 1659177614},
    {"Africa/Porto-Novo", 1659177614},
    {"Africa/Mogadishu", 1659177614},
    {"Africa/Abidjan", 1659177614},
    {"Africa/Lusaka", 1659177614},
    {"Africa/Lagos", 1659177614},
    {"Africa/Lubumbashi", 1659177614},
    {"Africa/Nairobi", 1659177614},
    {"Africa/Accra", 1659177614},
    {"Africa/Maseru", 1659177614},
    {"Africa/Lome", 1659177614},
    {"Africa/Douala", 1659177614},
    {"Africa/Bujumbura", 1659177614},
    {"Africa/Dar_es_Salaam", 1659177614},
    {"Africa/Gaborone", 1659177614},
    {"Australia/Adelaide", 1659177614},
    {"Australia/Broken_Hill", 1659177614},
    {"Australia/Perth", 1659177614},
    {"Australia/Darwin", 1659177614},
    {"Australia/Lord_Howe", 1659177614},
    {"Australia/Hobart", 1659177614},
    {"Australia/Brisbane", 1659177614},
    {"Australia/Sydney", 1659177614},
    {"Australia/Lindeman", 1659177614},
    {"Australia/Melbourne", 1659177614},
    {"Australia/Eucla", 1659177614},
    {"America/Grand_Turk", 1659177614},
    {"America/St_Thomas", 1659177614},
    {"America/Havana", 1659177614},
    {"America/Thunder_Bay", 1659177614},
    {"America/Inuvik", 1659177614},
    {"America/Winnipeg", 1659177614},
    {"America/Maceio", 1659177614},
    {"America/Chihuahua", 1659177614},
    {"America/North_Dakota/Beulah", 1659177614},
    {"America/North_Dakota/Center", 1659177614},
    {"America/North_Dakota/New_Salem", 1659177614},
    {"America/Campo_Grande", 1659177614},
    {"America/Scoresbysund", 1659177614},
    {"America/Tijuana", 1659177614},
    {"America/Bahia", 1659177614},
    {"America/St_Vincent", 1659177614},
    {"America/Creston", 1659177614},
    {"America/Dawson", 1659177614},
    {"America/Tegucigalpa", 1659177614},
    {"America/Lima", 1659177614},
    {"America/Mexico_City", 1659177614},
    {"America/Dominica", 1659177614},
    {"America/Atikokan", 1659177614},
    {"America/Port-au-Prince", 1659177614},
    {"America/Yakutat", 1659177614},
    {"America/St_Kitts", 1659177614},
    {"America/Guatemala", 1659177614},
    {"America/St_Barthelemy", 1659177614},
    {"America/Vancouver", 1659177614},
    {"America/Jamaica", 1659177614},
    {"America/Whitehorse", 1659177614},
    {"America/Asuncion", 1659177614},
    {"America/Toronto", 1659177614},
    {"America/Hermosillo", 1659177614},
    {"America/Denver", 1659177614},
    {"America/Mazatlan", 1659177614},
    {"America/Iqaluit", 1659177614},
    {"America/Nuuk", 1659177614},
    {"America/Cayenne", 1659177614},
    {"America/Santarem", 1659177614},
    {"America/Noronha", 1659177614},
    {"America/Ojinaga", 1659177614},
    {"America/Fort_Nelson", 1659177614},
    {"America/Aruba", 1659177614},
    {"America/Indiana/Vevay", 1659177614},
    {"America/Indiana/Marengo", 1659177614},
    {"America/Indiana/Indianapolis", 1659177614},
    {"America/Indiana/Tell_City", 1659177614},
    {"America/Indiana/Petersburg", 1659177614},
    {"America/Indiana/Winamac", 1659177614},
    {"America/Indiana/Knox", 1659177614},
    {"America/Indiana/Vincennes", 1659177614},
    {"America/Cayman", 1659177614},
    {"America/Sao_Paulo", 1659177614},
    {"America/Curacao", 1659177614},
    {"America/Anchorage", 1659177614},
    {"America/Guyana", 1659177614},
    {"America/Rankin_Inlet", 1659177614},
    {"America/Antigua", 1659177614},
    {"America/Juneau", 1659177614},
    {"America/Merida", 1659177614},
    {"America/Punta_Arenas", 1659177614},
    {"America/Moncton", 1659177614},
    {"America/Fortaleza", 1659177614},
    {"America/Resolute", 1659177614},
    {"America/Nassau", 1659177614},
    {"America/Edmonton", 1659177614},
    {"America/Regina", 1659177614},
    {"America/Halifax", 1659177614},
    {"America/Danmarkshavn", 1659177614},
    {"America/Metlakatla", 1659177614},
    {"America/Guadeloupe", 1659177614},
    {"America/Caracas", 1659177614},
    {"America/Detroit", 1659177614},
    {"America/Matamoros", 1659177614},
    {"America/Glace_Bay", 1659177614},
    {"America/Phoenix", 1659177614},
    {"America/La_Paz", 1659177614},
    {"America/Swift_Current", 1659177614},
    {"America/Nipigon", 1659177614},
    {"America/Cancun", 1659177614},
    {"America/Port_of_Spain", 1659177614},
    {"America/Kralendijk", 1659177614},
    {"America/Grenada", 1659177614},
    {"America/Belem", 1659177614},
    {"America/Managua", 1659177614},
    {"America/Adak", 1659177614},
    {"America/St_Lucia", 1659177614},
    {"America/Rio_Branco", 1659177614},
    {"America/Santiago", 1659177614},
    {"America/Puerto_Rico", 1659177614},
    {"America/Miquelon", 1659177614},
    {"America/Cuiaba", 1659177614},
    {"America/Martinique", 1659177614},
    {"America/Argentina/Buenos_Aires", 1659177614},
    {"America/Argentina/San_Luis", 1659177614},
    {"America/Argentina/Catamarca", 1659177614},
    {"America/Argentina/Jujuy", 1659177614},
    {"America/Argentina/Salta", 1659177614},
    {"America/Argentina/Ushuaia", 1659177614},
    {"America/Argentina/Mendoza", 1659177614},
    {"America/Argentina/Rio_Gallegos", 1659177614},
    {"America/Argentina/Tucuman", 1659177614},
    {"America/Argentina/San_Juan", 1659177614},
    {"America/Argentina/Cordoba", 1659177614},
    {"America/Argentina/La_Rioja", 1659177614},
    {"America/Barbados", 1659177614},
    {"America/Monterrey", 1659177614},
    {"America/Thule", 1659177614},
    {"America/Montserrat", 1659177614},
    {"America/Guayaquil", 1659177614},
    {"America/St_Johns", 1659177614},
    {"America/Boise", 1659177614},
    {"America/Manaus", 1659177614},
    {"America/Nome", 1659177614},
    {"America/Goose_Bay", 1659177614},
    {"America/Belize", 1659177614},
    {"America/Sitka", 1659177614},
    {"America/Dawson_Creek", 1659177614},
    {"America/Recife", 1659177614},
    {"America/Kentucky/Louisville", 1659177614},
    {"America/Kentucky/Monticello", 1659177614},
    {"America/New_York", 1659177614},
    {"America/Tortola", 1659177614},
    {"America/Chicago", 1659177614},
    {"America/Pangnirtung", 1659177614},
    {"America/Boa_Vista", 1659177614},
    {"America/Bogota", 1659177614},
    {"America/Rainy_River", 1659177614},
    {"America/El_Salvador", 1659177614},
    {"America/Bahia_Banderas", 1659177614},
    {"America/Yellowknife", 1659177614},
    {"America/Montevideo", 1659177614},
    {"America/Cambridge_Bay", 1659177614},
    {"America/Panama", 1659177614},
    {"America/Santo_Domingo", 1659177614},
    {"America/Anguilla", 1659177614},
    {"America/Paramaribo", 1659177614},
    {"America/Marigot", 1659177614},
    {"America/Menominee", 1659177614},
    {"America/Blanc-Sablon", 1659177614},
    {"America/Costa_Rica", 1659177614},
    {"America/Los_Angeles", 1659177614},
    {"America/Lower_Princes", 1659177614},
    {"America/Eirunepe", 1659177614},
    {"America/Araguaina", 1659177614},
    {"America/Porto_Velho", 1659177614},
    {"EST", 1659177614},
    {"CET", 1659177614},
    {"MST7MDT", 1659177614},
    {"Indian/Chagos", 1659177614},
    {"Indian/Kerguelen", 1659177614},
    {"Indian/Reunion", 1659177614},
    {"Indian/Antananarivo", 1659177614},
    {"Indian/Cocos", 1659177614},
    {"Indian/Mauritius", 1659177614},
    {"Indian/Christmas", 1659177614},
    {"Indian/Maldives", 1659177614},
    {"Indian/Comoro", 1659177614},
    {"Indian/Mahe", 1659177614},
    {"Indian/Mayotte", 1659177614},
    {"Asia/Novokuznetsk", 1659177614},
    {"Asia/Magadan", 1659177614},
    {"Asia/Yangon", 1659177614},
    {"Asia/Samarkand", 1659177614},
    {"Asia/Tehran", 1659177614},
    {"Asia/Dili", 1659177614},
    {"Asia/Yerevan", 1659177614},
    {"Asia/Qatar", 1659177614},
    {"Asia/Chita", 1659177614},
    {"Asia/Makassar", 1659177614},
    {"Asia/Hovd", 1659177614},
    {"Asia/Istanbul", 1659177614},
    {"Asia/Irkutsk", 1659177614},
    {"Asia/Pontianak", 1659177614},
    {"Asia/Qyzylorda", 1659177614},
    {"Asia/Srednekolymsk", 1659177614},
    {"Asia/Aden", 1659177614},
    {"Asia/Kabul", 1659177614},
    {"Asia/Macau", 1659177614},
    {"Asia/Riyadh", 1659177614},
    {"Asia/Taipei", 1659177614},
    {"Asia/Manila", 1659177614},
    {"Asia/Aqtau", 1659177614},
    {"Asia/Thimphu", 1659177614},
    {"Asia/Shanghai", 1659177614},
    {"Asia/Choibalsan", 1659177614},
    {"Asia/Nicosia", 1659177614},
    {"Asia/Dubai", 1659177614},
    {"Asia/Baku", 1659177614},
    {"Asia/Kuching", 1659177614},
    {"Asia/Gaza", 1659177614},
    {"Asia/Jayapura", 1659177614},
    {"Asia/Tokyo", 1659177614},
    {"Asia/Muscat", 1659177614},
    {"Asia/Kolkata", 1659177614},
    {"Asia/Ho_Chi_Minh", 1659177614},
    {"Asia/Tashkent", 1659177614},
    {"Asia/Bangkok", 1659177614},
    {"Asia/Karachi", 1659177614},
    {"Asia/Krasnoyarsk", 1659177614},
    {"Asia/Yekaterinburg", 1659177614},
    {"Asia/Famagusta", 1659177614},
    {"Asia/Ulaanbaatar", 1659177614},
    {"Asia/Bahrain", 1659177614},
    {"Asia/Barnaul", 1659177614},
    {"Asia/Jerusalem", 1659177614},
    {"Asia/Qostanay", 1659177614},
    {"Asia/Ust-Nera", 1659177614},
    {"Asia/Tomsk", 1659177614},
    {"Asia/Kuala_Lumpur", 1659177614},
    {"Asia/Brunei", 1659177614},
    {"Asia/Aqtobe", 1659177614},
    {"Asia/Vladivostok", 1659177614},
    {"Asia/Damascus", 1659177614},
    {"Asia/Omsk", 1659177614},
    {"Asia/Almaty", 1659177614},
    {"Asia/Dhaka", 1659177614},
    {"Asia/Tbilisi", 1659177614},
    {"Asia/Baghdad", 1659177614},
    {"Asia/Phnom_Penh", 1659177614},
    {"Asia/Kamchatka", 1659177614},
    {"Asia/Ashgabat", 1659177614},
    {"Asia/Sakhalin", 1659177614},
    {"Asia/Novosibirsk", 1659177614},
    {"Asia/Kuwait", 1659177614},
    {"Asia/Hong_Kong", 1659177614},
    {"Asia/Amman", 1659177614},
    {"Asia/Beirut", 1659177614},
    {"Asia/Yakutsk", 1659177614},
    {"Asia/Colombo", 1659177614},
    {"Asia/Oral", 1659177614},
    {"Asia/Kathmandu", 1659177614},
    {"Asia/Bishkek", 1659177614},
    {"Asia/Hebron", 1659177614},
    {"Asia/Singapore", 1659177614},
    {"Asia/Atyrau", 1659177614},
    {"Asia/Khandyga", 1659177614},
    {"Asia/Vientiane", 1659177614},
    {"Asia/Jakarta", 1659177614},
    {"Asia/Dushanbe", 1659177614},
    {"Asia/Seoul", 1659177614},
    {"Asia/Pyongyang", 1659177614},
    {"Asia/Urumqi", 1659177614},
    {"Asia/Anadyr", 1659177614},
    {"PST8PDT", 1659177614},
    {"HST", 1659177614},
    {"EST5EDT", 1659177614},
};

static time_t gTime = 1659177614;

/**
 * @tc.name      : mktime_0100
 * @tc.desc      : according to different time zones, convert time to seconds in duration since 1970-1-1
 * @tc.level     : Level 0
 */
void mktime_0100(void)
{
    for (int32_t i = 0; i < (int32_t)(sizeof(gResultData) / sizeof(gResultData[0])); i++) {
        const char *tz = gResultData[i].tz;
        const char *handlerChar;
#ifdef TIME_ZONE_SUB_TAG
        char *str = strrchr(tz, TIME_ZONE_SUB_TAG);
        if (str) {
            handlerChar = ++str;
        } else {
            handlerChar = tz;
        }
#else
        handlerChar = tz;
#endif
        setenv("TZ", handlerChar, 1);
        tzset();
        struct tm *timeptr = localtime(&gTime);
        if (!timeptr) {
            EXPECT_PTRNE("mktime_0100", timeptr, NULL);
            return;
        }
        time_t mk = mktime(timeptr);
        EXPECT_EQ("mktime_0100", mk, gResultData[i].result);
    }
}

int main(void)
{
    mktime_0100();
    return t_status;
}